---
description: Python development standards
globs: "**/*.py"
alwaysApply: false
---

# Python Development Standards

## Readability

Code should be easy to read and follow for someone unfamiliar with it. Prefer clarity over cleverness:

```python
# ❌ BAD - clever but unclear
result = [x for x in items if x.status == 'active' and x.score > threshold]

# ✅ GOOD - clear intent
active_items = [item for item in items if item.status == 'active']
high_scoring = [item for item in active_items if item.score > threshold]
```

Break complex expressions into intermediate variables with descriptive names. Structure code to tell a story.

## Type Annotations

Always add type annotations to function signatures, method parameters, and return types:

```python
def process_data(items: list[str], threshold: int) -> dict[str, int]:
    """Process items and return statistics."""
    ...
```

Use `typing` module for complex types (e.g., `Optional`, `Union`, `Callable`).

## Comments

Comment where code is not obvious. Explain the "why" for non-trivial logic, not the "what":

```python
# Use binary search because the list is sorted and large (>10k items)
result = bisect.bisect_left(sorted_list, target)
```

Avoid comments that restate what the code does.

## DRY Abstractions

Extract repeated patterns into functions, classes, or utilities. Prefer composition over duplication:

```python
# ❌ BAD - repeated pattern
if user.is_admin() and user.has_permission('read'):
    ...
if user.is_admin() and user.has_permission('write'):
    ...

# ✅ GOOD - abstracted
def admin_has_permission(user: User, permission: str) -> bool:
    return user.is_admin() and user.has_permission(permission)
```

## No Magic Variables

Avoid magic numbers, strings, or values. Use named constants or configuration:

```python
# ❌ BAD - magic number
if len(items) > 42:
    ...

# ✅ GOOD - named constant
MAX_BATCH_SIZE = 42
if len(items) > MAX_BATCH_SIZE:
    ...
```

Extract magic strings into constants or configuration files.

Avoid single-letter variable names (e.g., `a`, `n`, `b`). Use descriptive names:

```python
# ❌ BAD - single-letter variables
a = get_data()
n = len(a)
b = process(n)

# ✅ GOOD - descriptive names
data = get_data()
item_count = len(data)
result = process(item_count)
```
